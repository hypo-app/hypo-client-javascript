!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).hypo={})}(this,(function(e){"use strict";var r=require("../internals/export"),t=require("../internals/fails"),n=require("../internals/is-array"),i=require("../internals/is-object"),o=require("../internals/to-object"),a=require("../internals/to-length"),s=require("../internals/create-property"),u=require("../internals/array-species-create"),c=require("../internals/array-method-has-species-support"),l=require("../internals/well-known-symbol"),f=require("../internals/v8-version"),p=l("isConcatSpreadable"),v=f>=51||!t((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),d=c("concat"),g=function(e){if(!i(e))return!1;var r=e[p];return void 0!==r?!!r:n(e)};r({target:"Array",proto:!0,forced:!v||!d},{concat:function(e){var r,t,n,i,c,l=o(this),f=u(l,0),p=0;for(r=-1,n=arguments.length;r<n;r++)if(c=-1===r?l:arguments[r],g(c)){if(p+(i=a(c.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(t=0;t<i;t++,p++)t in c&&s(f,p,c[t])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");s(f,p++,c)}return f.length=p,f}});var h=require("../internals/to-indexed-object"),q=require("../internals/add-to-unscopables"),m=require("../internals/iterators"),x=require("../internals/internal-state"),y=require("../internals/define-iterator"),b=x.set,j=x.getterFor("Array Iterator");module.exports=y(Array,"Array",(function(e,r){b(this,{type:"Array Iterator",target:h(e),index:0,kind:r})}),(function(){var e=j(this),r=e.target,t=e.kind,n=e.index++;return!r||n>=r.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==t?{value:n,done:!1}:"values"==t?{value:r[n],done:!1}:{value:[n,r[n]],done:!1}}),"values"),m.Arguments=m.Array,q("keys"),q("values"),q("entries");var w=require("../internals/export"),k=require("../internals/array-iteration").map,S=require("../internals/fails"),O=require("../internals/array-method-has-species-support")("map"),P=O&&!S((function(){[].map.call({length:-1,0:1},(function(e){throw e}))}));w({target:"Array",proto:!0,forced:!O||!P},{map:function(e){return k(this,e,arguments.length>1?arguments[1]:void 0)}});var D=require("../internals/redefine"),E=Date.prototype,I=E.toString,T=E.getTime;new Date(NaN)+""!="Invalid Date"&&D(E,"toString",(function(){var e=T.call(this);return e==e?I.call(this):"Invalid Date"}));var A=require("../internals/export"),M=require("../internals/to-object"),H=require("../internals/object-keys");A({target:"Object",stat:!0,forced:require("../internals/fails")((function(){H(1)}))},{keys:function(e){return H(M(e))}});var R=require("../internals/to-string-tag-support"),C=require("../internals/redefine"),$=require("../internals/object-to-string");R||C(Object.prototype,"toString",$,{unsafe:!0});var U,N,X,F,J=require("../internals/export"),G=require("../internals/is-pure"),L=require("../internals/global"),_=require("../internals/get-built-in"),V=require("../internals/native-promise-constructor"),z=require("../internals/redefine"),B=require("../internals/redefine-all"),K=require("../internals/set-to-string-tag"),Q=require("../internals/set-species"),W=require("../internals/is-object"),Y=require("../internals/a-function"),Z=require("../internals/an-instance"),ee=require("../internals/classof-raw"),re=require("../internals/inspect-source"),te=require("../internals/iterate"),ne=require("../internals/check-correctness-of-iteration"),ie=require("../internals/species-constructor"),oe=require("../internals/task").set,ae=require("../internals/microtask"),se=require("../internals/promise-resolve"),ue=require("../internals/host-report-errors"),ce=require("../internals/new-promise-capability"),le=require("../internals/perform"),fe=require("../internals/internal-state"),pe=require("../internals/is-forced"),ve=require("../internals/well-known-symbol"),de=require("../internals/v8-version"),ge=ve("species"),he="Promise",qe=fe.get,me=fe.set,xe=fe.getterFor(he),ye=V,be=L.TypeError,je=L.document,we=L.process,ke=_("fetch"),Se=ce.f,Oe=Se,Pe="process"==ee(we),De=!!(je&&je.createEvent&&L.dispatchEvent),Ee=pe(he,(function(){if(!(re(ye)!==String(ye))){if(66===de)return!0;if(!Pe&&"function"!=typeof PromiseRejectionEvent)return!0}if(G&&!ye.prototype.finally)return!0;if(de>=51&&/native code/.test(ye))return!1;var e=ye.resolve(1),r=function(e){e((function(){}),(function(){}))};return(e.constructor={})[ge]=r,!(e.then((function(){}))instanceof r)})),Ie=Ee||!ne((function(e){ye.all(e).catch((function(){}))})),Te=function(e){var r;return!(!W(e)||"function"!=typeof(r=e.then))&&r},Ae=function(e,r,t){if(!r.notified){r.notified=!0;var n=r.reactions;ae((function(){for(var i=r.value,o=1==r.state,a=0;n.length>a;){var s,u,c,l=n[a++],f=o?l.ok:l.fail,p=l.resolve,v=l.reject,d=l.domain;try{f?(o||(2===r.rejection&&Ce(e,r),r.rejection=1),!0===f?s=i:(d&&d.enter(),s=f(i),d&&(d.exit(),c=!0)),s===l.promise?v(be("Promise-chain cycle")):(u=Te(s))?u.call(s,p,v):p(s)):v(i)}catch(e){d&&!c&&d.exit(),v(e)}}r.reactions=[],r.notified=!1,t&&!r.rejection&&He(e,r)}))}},Me=function(e,r,t){var n,i;De?((n=je.createEvent("Event")).promise=r,n.reason=t,n.initEvent(e,!1,!0),L.dispatchEvent(n)):n={promise:r,reason:t},(i=L["on"+e])?i(n):"unhandledrejection"===e&&ue("Unhandled promise rejection",t)},He=function(e,r){oe.call(L,(function(){var t,n=r.value;if(Re(r)&&(t=le((function(){Pe?we.emit("unhandledRejection",n,e):Me("unhandledrejection",e,n)})),r.rejection=Pe||Re(r)?2:1,t.error))throw t.value}))},Re=function(e){return 1!==e.rejection&&!e.parent},Ce=function(e,r){oe.call(L,(function(){Pe?we.emit("rejectionHandled",e):Me("rejectionhandled",e,r.value)}))},$e=function(e,r,t,n){return function(i){e(r,t,i,n)}},Ue=function(e,r,t,n){r.done||(r.done=!0,n&&(r=n),r.value=t,r.state=2,Ae(e,r,!0))},Ne=function(e,r,t,n){if(!r.done){r.done=!0,n&&(r=n);try{if(e===t)throw be("Promise can't be resolved itself");var i=Te(t);i?ae((function(){var n={done:!1};try{i.call(t,$e(Ne,e,n,r),$e(Ue,e,n,r))}catch(t){Ue(e,n,t,r)}})):(r.value=t,r.state=1,Ae(e,r,!1))}catch(t){Ue(e,{done:!1},t,r)}}};Ee&&(ye=function(e){Z(this,ye,he),Y(e),U.call(this);var r=qe(this);try{e($e(Ne,this,r),$e(Ue,this,r))}catch(e){Ue(this,r,e)}},(U=function(e){me(this,{type:he,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=B(ye.prototype,{then:function(e,r){var t=xe(this),n=Se(ie(this,ye));return n.ok="function"!=typeof e||e,n.fail="function"==typeof r&&r,n.domain=Pe?we.domain:void 0,t.parent=!0,t.reactions.push(n),0!=t.state&&Ae(this,t,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),N=function(){var e=new U,r=qe(e);this.promise=e,this.resolve=$e(Ne,e,r),this.reject=$e(Ue,e,r)},ce.f=Se=function(e){return e===ye||e===X?new N(e):Oe(e)},G||"function"!=typeof V||(F=V.prototype.then,z(V.prototype,"then",(function(e,r){var t=this;return new ye((function(e,r){F.call(t,e,r)})).then(e,r)}),{unsafe:!0}),"function"==typeof ke&&J({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return se(ye,ke.apply(L,arguments))}}))),J({global:!0,wrap:!0,forced:Ee},{Promise:ye}),K(ye,he,!1,!0),Q(he),X=_(he),J({target:he,stat:!0,forced:Ee},{reject:function(e){var r=Se(this);return r.reject.call(void 0,e),r.promise}}),J({target:he,stat:!0,forced:G||Ee},{resolve:function(e){return se(G&&this===X?ye:this,e)}}),J({target:he,stat:!0,forced:Ie},{all:function(e){var r=this,t=Se(r),n=t.resolve,i=t.reject,o=le((function(){var t=Y(r.resolve),o=[],a=0,s=1;te(e,(function(e){var u=a++,c=!1;o.push(void 0),s++,t.call(r,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),t.promise},race:function(e){var r=this,t=Se(r),n=t.reject,i=le((function(){var i=Y(r.resolve);te(e,(function(e){i.call(r,e).then(t.resolve,n)}))}));return i.error&&n(i.value),t.promise}});var Xe=require("../internals/export"),Fe=require("../internals/regexp-exec");Xe({target:"RegExp",proto:!0,forced:/./.exec!==Fe},{exec:Fe});var Je=require("../internals/redefine"),Ge=require("../internals/an-object"),Le=require("../internals/fails"),_e=require("../internals/regexp-flags"),Ve=RegExp.prototype,ze=Ve.toString,Be=Le((function(){return"/a/b"!=ze.call({source:"a",flags:"b"})})),Ke="toString"!=ze.name;(Be||Ke)&&Je(RegExp.prototype,"toString",(function(){var e=Ge(this),r=String(e.source),t=e.flags;return"/"+r+"/"+String(void 0===t&&e instanceof RegExp&&!("flags"in Ve)?_e.call(e):t)}),{unsafe:!0});var Qe=require("../internals/string-multibyte").charAt,We=require("../internals/internal-state"),Ye=require("../internals/define-iterator"),Ze=We.set,er=We.getterFor("String Iterator");Ye(String,"String",(function(e){Ze(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,r=er(this),t=r.string,n=r.index;return n>=t.length?{value:void 0,done:!0}:(e=Qe(t,n),r.index+=e.length,{value:e,done:!1})}));var rr=require("../internals/fix-regexp-well-known-symbol-logic"),tr=require("../internals/an-object"),nr=require("../internals/to-length"),ir=require("../internals/require-object-coercible"),or=require("../internals/advance-string-index"),ar=require("../internals/regexp-exec-abstract");rr("match",1,(function(e,r,t){return[function(r){var t=ir(this),n=null==r?void 0:r[e];return void 0!==n?n.call(r,t):new RegExp(r)[e](String(t))},function(e){var n=t(r,e,this);if(n.done)return n.value;var i=tr(e),o=String(this);if(!i.global)return ar(i,o);var a=i.unicode;i.lastIndex=0;for(var s,u=[],c=0;null!==(s=ar(i,o));){var l=String(s[0]);u[c]=l,""===l&&(i.lastIndex=or(o,nr(i.lastIndex),a)),c++}return 0===c?null:u}]}));var sr=require("../internals/fix-regexp-well-known-symbol-logic"),ur=require("../internals/an-object"),cr=require("../internals/to-object"),lr=require("../internals/to-length"),fr=require("../internals/to-integer"),pr=require("../internals/require-object-coercible"),vr=require("../internals/advance-string-index"),dr=require("../internals/regexp-exec-abstract"),gr=Math.max,hr=Math.min,qr=Math.floor,mr=/\$([$&'`]|\d\d?|<[^>]*>)/g,xr=/\$([$&'`]|\d\d?)/g;sr("replace",2,(function(e,r,t){return[function(t,n){var i=pr(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,i,n):r.call(String(i),t,n)},function(e,i){var o=t(r,e,this,i);if(o.done)return o.value;var a=ur(e),s=String(this),u="function"==typeof i;u||(i=String(i));var c=a.global;if(c){var l=a.unicode;a.lastIndex=0}for(var f=[];;){var p=dr(a,s);if(null===p)break;if(f.push(p),!c)break;""===String(p[0])&&(a.lastIndex=vr(s,lr(a.lastIndex),l))}for(var v,d="",g=0,h=0;h<f.length;h++){p=f[h];for(var q=String(p[0]),m=gr(hr(fr(p.index),s.length),0),x=[],y=1;y<p.length;y++)x.push(void 0===(v=p[y])?v:String(v));var b=p.groups;if(u){var j=[q].concat(x,m,s);void 0!==b&&j.push(b);var w=String(i.apply(void 0,j))}else w=n(q,s,m,x,b,i);m>=g&&(d+=s.slice(g,m)+w,g=m+q.length)}return d+s.slice(g)}];function n(e,t,n,i,o,a){var s=n+e.length,u=i.length,c=xr;return void 0!==o&&(o=cr(o),c=mr),r.call(a,c,(function(r,a){var c;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(s);case"<":c=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return r;if(l>u){var f=qr(l/10);return 0===f?r:f<=u?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):r}c=i[l-1]}return void 0===c?"":c}))}}));var yr=require("../internals/global"),br=require("../internals/dom-iterables"),jr=require("../modules/es.array.iterator"),wr=require("../internals/create-non-enumerable-property"),kr=require("../internals/well-known-symbol"),Sr=kr("iterator"),Or=kr("toStringTag"),Pr=jr.values;for(var Dr in br){var Er=yr[Dr],Ir=Er&&Er.prototype;if(Ir){if(Ir[Sr]!==Pr)try{wr(Ir,Sr,Pr)}catch(e){Ir[Sr]=Pr}if(Ir[Or]||wr(Ir,Or,Dr),br[Dr])for(var Tr in jr)if(Ir[Tr]!==jr[Tr])try{wr(Ir,Tr,jr[Tr])}catch(e){Ir[Tr]=jr[Tr]}}}function Ar(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Mr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Hr(e){var r=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return r?r[2]:null}function Rr(e,r,t){var n=new Date;n.setTime(n.getTime()+36e5*t);var i=e+"="+r+";path=/;expires="+n.toGMTString();$r.cookieDomain&&(i+=";domain="+$r.cookieDomain),document.cookie=i}var Cr="0.0.1",$r={cookiePrefix:"hypo",baseUrl:"https://api.hypo.app",project:null,userIdCookieDurationHours:17520,groupAssignmentCookieDurationHours:6,cookieDomain:null,requestTimeoutMs:5e3};function Ur(){var e,r,t=Hr($r.cookiePrefix+"-uid");return t||(e=(new Date).getTime(),r=0,"undefined"!=typeof performance&&(r=performance&&performance.now&&1e3*performance.now()||0),Nr(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(r+n)%16|0,r=Math.floor(r/16)),("x"===t?n:3&n|8).toString(16)})))),t}function Nr(e){Rr($r.cookiePrefix+"-uid",e,$r.userIdCookieDurationHours)}function Xr(){return{"Content-Type":"application/json","X-Hypo-Client":"js-web","X-Hypo-Client-Version":Cr}}e.event=function(e,r){var t={user:Ur(),event:e};null!=r&&(t.revenue=r);var n="".concat($r.baseUrl,"/project/").concat($r.project,"/event"),i=JSON.stringify(t),o=Xr();return new Promise((function(e,r){var t=new XMLHttpRequest;t.open("POST",n,!0),t.timeout=$r.requestTimeoutMs,Object.keys(o).map((function(e){return t.setRequestHeader(e,o[e])})),t.onload=function(){t.status>=200&&t.status<300?e():r()},t.ontimeout=function(){r()},t.onerror=function(){r()},t.onabort=function(){r()},t.send(i)}))},e.getGroupAssignment=function(e){var r=$r.cookiePrefix+"-eid-"+e,t=Ur(),n=Hr(r);if(n)return Promise.resolve(n);var i="".concat($r.baseUrl,"/project/").concat($r.project,"/experiment/").concat(e,"/group/assignment"),o=JSON.stringify({user:t}),a=Xr();return new Promise((function(e,t){var n=new XMLHttpRequest;n.open("POST",i,!0),n.timeout=$r.requestTimeoutMs,Object.keys(a).map((function(e){return n.setRequestHeader(e,a[e])})),n.onload=function(){if(n.status>=200&&n.status<300){var i=JSON.parse(n.responseText);Rr(r,i.group,$r.groupAssignmentCookieDurationHours),e(i.group)}else t()},n.ontimeout=function(){t()},n.onerror=function(){t()},n.onabort=function(){t()},n.send(o)}))},e.getUserId=Ur,e.init=function(e){$r=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Mr(Object(t),!0).forEach((function(r){Ar(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Mr(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},$r,{},e)},e.setUserId=Nr,Object.defineProperty(e,"__esModule",{value:!0})}));
