!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).hypo={})}(this,(function(e){"use strict";var r=require("../internals/export"),t=require("../internals/fails"),n=require("../internals/is-array"),i=require("../internals/is-object"),o=require("../internals/to-object"),a=require("../internals/to-length"),u=require("../internals/create-property"),s=require("../internals/array-species-create"),c=require("../internals/array-method-has-species-support"),l=require("../internals/well-known-symbol"),f=require("../internals/v8-version"),p=l("isConcatSpreadable"),d=f>=51||!t((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),v=c("concat"),h=function(e){if(!i(e))return!1;var r=e[p];return void 0!==r?!!r:n(e)};r({target:"Array",proto:!0,forced:!d||!v},{concat:function(e){var r,t,n,i,c,l=o(this),f=s(l,0),p=0;for(r=-1,n=arguments.length;r<n;r++)if(c=-1===r?l:arguments[r],h(c)){if(p+(i=a(c.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(t=0;t<i;t++,p++)t in c&&u(f,p,c[t])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");u(f,p++,c)}return f.length=p,f}});var g=require("../internals/to-indexed-object"),m=require("../internals/add-to-unscopables"),q=require("../internals/iterators"),x=require("../internals/internal-state"),y=require("../internals/define-iterator"),b=x.set,j=x.getterFor("Array Iterator");module.exports=y(Array,"Array",(function(e,r){b(this,{type:"Array Iterator",target:g(e),index:0,kind:r})}),(function(){var e=j(this),r=e.target,t=e.kind,n=e.index++;return!r||n>=r.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==t?{value:n,done:!1}:"values"==t?{value:r[n],done:!1}:{value:[n,r[n]],done:!1}}),"values"),q.Arguments=q.Array,m("keys"),m("values"),m("entries");var w=require("../internals/export"),k=require("../internals/array-iteration").map,S=require("../internals/fails"),O=require("../internals/array-method-has-species-support")("map"),P=O&&!S((function(){[].map.call({length:-1,0:1},(function(e){throw e}))}));w({target:"Array",proto:!0,forced:!O||!P},{map:function(e){return k(this,e,arguments.length>1?arguments[1]:void 0)}});var T=require("../internals/redefine"),E=Date.prototype,A=E.toString,D=E.getTime;new Date(NaN)+""!="Invalid Date"&&T(E,"toString",(function(){var e=D.call(this);return e==e?A.call(this):"Invalid Date"}));var I=require("../internals/export"),M=require("../internals/to-object"),H=require("../internals/object-keys");I({target:"Object",stat:!0,forced:require("../internals/fails")((function(){H(1)}))},{keys:function(e){return H(M(e))}});var R=require("../internals/to-string-tag-support"),C=require("../internals/redefine"),U=require("../internals/object-to-string");R||C(Object.prototype,"toString",U,{unsafe:!0});var $,N,X,F,J=require("../internals/export"),G=require("../internals/is-pure"),L=require("../internals/global"),_=require("../internals/get-built-in"),V=require("../internals/native-promise-constructor"),z=require("../internals/redefine"),B=require("../internals/redefine-all"),K=require("../internals/set-to-string-tag"),Q=require("../internals/set-species"),W=require("../internals/is-object"),Y=require("../internals/a-function"),Z=require("../internals/an-instance"),ee=require("../internals/classof-raw"),re=require("../internals/inspect-source"),te=require("../internals/iterate"),ne=require("../internals/check-correctness-of-iteration"),ie=require("../internals/species-constructor"),oe=require("../internals/task").set,ae=require("../internals/microtask"),ue=require("../internals/promise-resolve"),se=require("../internals/host-report-errors"),ce=require("../internals/new-promise-capability"),le=require("../internals/perform"),fe=require("../internals/internal-state"),pe=require("../internals/is-forced"),de=require("../internals/well-known-symbol"),ve=require("../internals/v8-version"),he=de("species"),ge="Promise",me=fe.get,qe=fe.set,xe=fe.getterFor(ge),ye=V,be=L.TypeError,je=L.document,we=L.process,ke=_("fetch"),Se=ce.f,Oe=Se,Pe="process"==ee(we),Te=!!(je&&je.createEvent&&L.dispatchEvent),Ee=pe(ge,(function(){if(!(re(ye)!==String(ye))){if(66===ve)return!0;if(!Pe&&"function"!=typeof PromiseRejectionEvent)return!0}if(G&&!ye.prototype.finally)return!0;if(ve>=51&&/native code/.test(ye))return!1;var e=ye.resolve(1),r=function(e){e((function(){}),(function(){}))};return(e.constructor={})[he]=r,!(e.then((function(){}))instanceof r)})),Ae=Ee||!ne((function(e){ye.all(e).catch((function(){}))})),De=function(e){var r;return!(!W(e)||"function"!=typeof(r=e.then))&&r},Ie=function(e,r,t){if(!r.notified){r.notified=!0;var n=r.reactions;ae((function(){for(var i=r.value,o=1==r.state,a=0;n.length>a;){var u,s,c,l=n[a++],f=o?l.ok:l.fail,p=l.resolve,d=l.reject,v=l.domain;try{f?(o||(2===r.rejection&&Ce(e,r),r.rejection=1),!0===f?u=i:(v&&v.enter(),u=f(i),v&&(v.exit(),c=!0)),u===l.promise?d(be("Promise-chain cycle")):(s=De(u))?s.call(u,p,d):p(u)):d(i)}catch(e){v&&!c&&v.exit(),d(e)}}r.reactions=[],r.notified=!1,t&&!r.rejection&&He(e,r)}))}},Me=function(e,r,t){var n,i;Te?((n=je.createEvent("Event")).promise=r,n.reason=t,n.initEvent(e,!1,!0),L.dispatchEvent(n)):n={promise:r,reason:t},(i=L["on"+e])?i(n):"unhandledrejection"===e&&se("Unhandled promise rejection",t)},He=function(e,r){oe.call(L,(function(){var t,n=r.value;if(Re(r)&&(t=le((function(){Pe?we.emit("unhandledRejection",n,e):Me("unhandledrejection",e,n)})),r.rejection=Pe||Re(r)?2:1,t.error))throw t.value}))},Re=function(e){return 1!==e.rejection&&!e.parent},Ce=function(e,r){oe.call(L,(function(){Pe?we.emit("rejectionHandled",e):Me("rejectionhandled",e,r.value)}))},Ue=function(e,r,t,n){return function(i){e(r,t,i,n)}},$e=function(e,r,t,n){r.done||(r.done=!0,n&&(r=n),r.value=t,r.state=2,Ie(e,r,!0))},Ne=function(e,r,t,n){if(!r.done){r.done=!0,n&&(r=n);try{if(e===t)throw be("Promise can't be resolved itself");var i=De(t);i?ae((function(){var n={done:!1};try{i.call(t,Ue(Ne,e,n,r),Ue($e,e,n,r))}catch(t){$e(e,n,t,r)}})):(r.value=t,r.state=1,Ie(e,r,!1))}catch(t){$e(e,{done:!1},t,r)}}};Ee&&(ye=function(e){Z(this,ye,ge),Y(e),$.call(this);var r=me(this);try{e(Ue(Ne,this,r),Ue($e,this,r))}catch(e){$e(this,r,e)}},($=function(e){qe(this,{type:ge,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=B(ye.prototype,{then:function(e,r){var t=xe(this),n=Se(ie(this,ye));return n.ok="function"!=typeof e||e,n.fail="function"==typeof r&&r,n.domain=Pe?we.domain:void 0,t.parent=!0,t.reactions.push(n),0!=t.state&&Ie(this,t,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),N=function(){var e=new $,r=me(e);this.promise=e,this.resolve=Ue(Ne,e,r),this.reject=Ue($e,e,r)},ce.f=Se=function(e){return e===ye||e===X?new N(e):Oe(e)},G||"function"!=typeof V||(F=V.prototype.then,z(V.prototype,"then",(function(e,r){var t=this;return new ye((function(e,r){F.call(t,e,r)})).then(e,r)}),{unsafe:!0}),"function"==typeof ke&&J({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return ue(ye,ke.apply(L,arguments))}}))),J({global:!0,wrap:!0,forced:Ee},{Promise:ye}),K(ye,ge,!1,!0),Q(ge),X=_(ge),J({target:ge,stat:!0,forced:Ee},{reject:function(e){var r=Se(this);return r.reject.call(void 0,e),r.promise}}),J({target:ge,stat:!0,forced:G||Ee},{resolve:function(e){return ue(G&&this===X?ye:this,e)}}),J({target:ge,stat:!0,forced:Ae},{all:function(e){var r=this,t=Se(r),n=t.resolve,i=t.reject,o=le((function(){var t=Y(r.resolve),o=[],a=0,u=1;te(e,(function(e){var s=a++,c=!1;o.push(void 0),u++,t.call(r,e).then((function(e){c||(c=!0,o[s]=e,--u||n(o))}),i)})),--u||n(o)}));return o.error&&i(o.value),t.promise},race:function(e){var r=this,t=Se(r),n=t.reject,i=le((function(){var i=Y(r.resolve);te(e,(function(e){i.call(r,e).then(t.resolve,n)}))}));return i.error&&n(i.value),t.promise}});var Xe=require("../internals/export"),Fe=require("../internals/regexp-exec");Xe({target:"RegExp",proto:!0,forced:/./.exec!==Fe},{exec:Fe});var Je=require("../internals/redefine"),Ge=require("../internals/an-object"),Le=require("../internals/fails"),_e=require("../internals/regexp-flags"),Ve=RegExp.prototype,ze=Ve.toString,Be=Le((function(){return"/a/b"!=ze.call({source:"a",flags:"b"})})),Ke="toString"!=ze.name;(Be||Ke)&&Je(RegExp.prototype,"toString",(function(){var e=Ge(this),r=String(e.source),t=e.flags;return"/"+r+"/"+String(void 0===t&&e instanceof RegExp&&!("flags"in Ve)?_e.call(e):t)}),{unsafe:!0});var Qe=require("../internals/string-multibyte").charAt,We=require("../internals/internal-state"),Ye=require("../internals/define-iterator"),Ze=We.set,er=We.getterFor("String Iterator");Ye(String,"String",(function(e){Ze(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,r=er(this),t=r.string,n=r.index;return n>=t.length?{value:void 0,done:!0}:(e=Qe(t,n),r.index+=e.length,{value:e,done:!1})}));var rr=require("../internals/fix-regexp-well-known-symbol-logic"),tr=require("../internals/an-object"),nr=require("../internals/to-length"),ir=require("../internals/require-object-coercible"),or=require("../internals/advance-string-index"),ar=require("../internals/regexp-exec-abstract");rr("match",1,(function(e,r,t){return[function(r){var t=ir(this),n=null==r?void 0:r[e];return void 0!==n?n.call(r,t):new RegExp(r)[e](String(t))},function(e){var n=t(r,e,this);if(n.done)return n.value;var i=tr(e),o=String(this);if(!i.global)return ar(i,o);var a=i.unicode;i.lastIndex=0;for(var u,s=[],c=0;null!==(u=ar(i,o));){var l=String(u[0]);s[c]=l,""===l&&(i.lastIndex=or(o,nr(i.lastIndex),a)),c++}return 0===c?null:s}]}));var ur=require("../internals/fix-regexp-well-known-symbol-logic"),sr=require("../internals/an-object"),cr=require("../internals/to-object"),lr=require("../internals/to-length"),fr=require("../internals/to-integer"),pr=require("../internals/require-object-coercible"),dr=require("../internals/advance-string-index"),vr=require("../internals/regexp-exec-abstract"),hr=Math.max,gr=Math.min,mr=Math.floor,qr=/\$([$&'`]|\d\d?|<[^>]*>)/g,xr=/\$([$&'`]|\d\d?)/g;ur("replace",2,(function(e,r,t){return[function(t,n){var i=pr(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,i,n):r.call(String(i),t,n)},function(e,i){var o=t(r,e,this,i);if(o.done)return o.value;var a=sr(e),u=String(this),s="function"==typeof i;s||(i=String(i));var c=a.global;if(c){var l=a.unicode;a.lastIndex=0}for(var f=[];;){var p=vr(a,u);if(null===p)break;if(f.push(p),!c)break;""===String(p[0])&&(a.lastIndex=dr(u,lr(a.lastIndex),l))}for(var d,v="",h=0,g=0;g<f.length;g++){p=f[g];for(var m=String(p[0]),q=hr(gr(fr(p.index),u.length),0),x=[],y=1;y<p.length;y++)x.push(void 0===(d=p[y])?d:String(d));var b=p.groups;if(s){var j=[m].concat(x,q,u);void 0!==b&&j.push(b);var w=String(i.apply(void 0,j))}else w=n(m,u,q,x,b,i);q>=h&&(v+=u.slice(h,q)+w,h=q+m.length)}return v+u.slice(h)}];function n(e,t,n,i,o,a){var u=n+e.length,s=i.length,c=xr;return void 0!==o&&(o=cr(o),c=qr),r.call(a,c,(function(r,a){var c;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(u);case"<":c=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return r;if(l>s){var f=mr(l/10);return 0===f?r:f<=s?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):r}c=i[l-1]}return void 0===c?"":c}))}}));var yr=require("../internals/global"),br=require("../internals/dom-iterables"),jr=require("../modules/es.array.iterator"),wr=require("../internals/create-non-enumerable-property"),kr=require("../internals/well-known-symbol"),Sr=kr("iterator"),Or=kr("toStringTag"),Pr=jr.values;for(var Tr in br){var Er=yr[Tr],Ar=Er&&Er.prototype;if(Ar){if(Ar[Sr]!==Pr)try{wr(Ar,Sr,Pr)}catch(e){Ar[Sr]=Pr}if(Ar[Or]||wr(Ar,Or,Tr),br[Tr])for(var Dr in jr)if(Ar[Dr]!==jr[Dr])try{wr(Ar,Dr,jr[Dr])}catch(e){Ar[Dr]=jr[Dr]}}}function Ir(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Mr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Hr(e){var r="";if(Ur.request?r=Ur.request.headers.get("cookie"):"undefined"!=typeof document&&void 0!==document.cookie&&(r=document.cookie),!r)return null;var t=r.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}function Rr(e,r,t){var n=new Date;n.setTime(n.getTime()+36e5*t);var i=e+"="+r+";path=/;expires="+n.toGMTString();Ur.cookieDomain&&(i+=";domain="+Ur.cookieDomain),Ur.response?Ur.response.headers.append("Set-Cookie",i):"undefined"!=typeof document&&void 0!==document.cookie&&(document.cookie=i)}var Cr="0.0.1",Ur={cookiePrefix:"hypo",baseUrl:"http://localhost:5000",project:null,userIdCookieDurationHours:17520,groupAssignmentCookieDurationHours:6,request:null,response:null,cookieDomain:null,requestTimeoutMs:5e3};function $r(){var e,r,t=Hr(Ur.cookiePrefix+"-uid");return t||(e=(new Date).getTime(),r=0,"undefined"!=typeof performance&&(r=performance&&performance.now&&1e3*performance.now()||0),Nr(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(r+n)%16|0,r=Math.floor(r/16)),("x"===t?n:3&n|8).toString(16)})))),t}function Nr(e){Rr(Ur.cookiePrefix+"-uid",e,Ur.userIdCookieDurationHours)}function Xr(e){var r=new Promise((function(e){setTimeout(e,Ur.requestTimeoutMs,{timeout:!0})}));return Promise.race([e.then((function(e){return{value:e,timeout:!1}})),r]).then((function(e){if(e.timeout)throw new Error("timeout");return e.value}))}function Fr(){var e={"Content-Type":"application/json","X-Hypo-Client":Ur.request?"js-cf-worker":"js-web","X-Hypo-Client-Version":Cr};return Ur.request&&(e["User-Agent"]=Ur.request.headers.get("User-Agent")||""),e}e.event=function(e,r){var t={user:$r(),event:e};null!=r&&(t.revenue=r);var n="".concat(Ur.baseUrl,"/project/").concat(Ur.project,"/event"),i=JSON.stringify(t),o=Fr();return fetch?Xr(fetch(n,{method:"POST",headers:o,body:i}).then((function(e){if(!e.ok)throw new Error(e.statusText);return""}))):new Promise((function(e,r){var t=new XMLHttpRequest;t.open("POST",n,!0),t.timeout=Ur.requestTimeoutMs,Object.keys().map((function(e){return t.setRequestHeader(e,o[e])})),t.onload=function(){t.status>=200&&t.status<300?e():r()},t.ontimeout=function(){r()},t.onerror=function(){r()},t.onabort=function(){r()},t.send(i)}))},e.getGroupAssignment=function(e){var r=Ur.cookiePrefix+"-eid-"+e,t=$r(),n=Hr(r);if(n)return Promise.resolve(n);var i="".concat(Ur.baseUrl,"/project/").concat(Ur.project,"/experiment/").concat(e,"/group/assignment"),o=JSON.stringify({user:t}),a=function(e){return Rr(r,e.group,Ur.groupAssignmentCookieDurationHours),e.group},u=Fr();return fetch?Xr(fetch(i,{method:"POST",headers:u,body:o}).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then(a)):new Promise((function(e,r){var t=new XMLHttpRequest;t.open("POST",i,!0),t.timeout=Ur.requestTimeoutMs,Object.keys().map((function(e){return t.setRequestHeader(e,u[e])})),t.onload=function(){if(t.status>=200&&t.status<300){var n=JSON.parse(t.responseText);a(n),e(n.group)}else r()},t.ontimeout=function(){r()},t.onerror=function(){r()},t.onabort=function(){r()},t.send(o)}))},e.getUserId=$r,e.init=function(e){Ur=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Mr(Object(t),!0).forEach((function(r){Ir(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Mr(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},Ur,{},e)},e.setUserId=Nr,Object.defineProperty(e,"__esModule",{value:!0})}));
